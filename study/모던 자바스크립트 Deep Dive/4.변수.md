# 4. 변수

## 4.1. 변수란 무엇인가? 왜 필요한가?

변수: 하나의 값을 저장하기 위해 확보한 메모리공간 자체 또는 그 메모리 공간을 식별하기 위해 붙인 이름을 말한다. 값의 위치를 가리키는 상정적인 이름

변수명: 메모리 공간에 저장된 값을 식별할 수 있는 고유한 이름

변수값: 변수에 지정된값

할당: 변수에 값을 지정하는 행위

참조: 변수의 값을 읽어들이는 행위

사람이 기계어로 개발 하기는 불편하기 때문에 사람이 기계에게 명령하기 편한 방법을 만들었고 그중 하나가 변수다.

## 4.2. 식별자(identifier)

식별자: 어떤 값을 구별해서 식별할수 있는 고유한 이름을 말한다.

식별자는 값이 아니라 메모리 주소를 기억하고 있다.

변수, 함수, 클레스 등의 이름은 모두 식별자다. 네이밍 규칙을 준수해야 하며 `선언`에 의해 자바스크립트 엔진에 존재를 알린다.

## 4.3. 변수 선언(variable declaration)

변수선언: 변수를 생성하는것을 말한다, 메모리를 할당(allocate)하고 변수이름과 확보된 메모리공간 주소를 연결(name binding)해서 값을 저장 할 수 있게 해준다.

변수를 사용하려면 반드시 선언이 필요하다. 변수를 선언할때는 var, let, const 키워드를 사용한다.

> var키워드는 여러 단점이 있다. 대표적으로는 `블록 레벨 스코프`가 아닌 `함수 레벨 스코프`를 지원한다는 것 이다. 이로 인해 전역변수가 선언되어 심각한 부작용이 발생하기도 한다.

변수 선언 후 값을 할당하지 않아도 자바스크립트 엔진에 의해 `undefined`가 암묵적으로 할당된다.

자바스크립트 엔진은 변수선언을 2단계에 거쳐 수행한다.

- 선언단계: 변수 이름을 등록
- 초기화 단계: 값을 저장하기 위한 메모리 공간을 확보하고 암묵적으로 undefined를 할당해 초기화 한다.

> **변수 이름은 어디에 등록되는가?**
>
> 변수 이름을 비롯한 모든 식별자는 실행컨텍스트에 등록된다.
> 실행컨텍스트는 자바스크립트 엔진이 소스코드를 평가하고 실행하기 위해 필요한 환경을 제공하고 코드의 실행결과를 실제로 관리하는 영역이다.
> 변수 이름과 변수 값은 실행 컨텍스트 내에 키(key)/값(value) 형식의 객체로 관리된다.

모든 식별자는 선언이 필요하다. 선언하지 않은 식별자에 접근하면 `ReferenceError(참조에러)`가 발생한다.

## 4.4. 변수 선언의 실행 시점과 변수 호이스팅

```ts
console.log(score);

var score;
```

변수 선언문 보다 앞서 변수를 참조하는 코드가 있다.
자바 스크립트 코드는 인터프리터에 의해 한줄씩 순차적으로 실행되므로 `console.log(score);`가 실행되는 시점에는 score의 선언이 실행되지 않았으므로 참조에러가 발생할것으로 생각 되지만 undefined가 출력된다.

그 이유는 변수선언이 런타이이 아닌 그 이전 단계에서 먼저 실행되기 때문이다.

자바스크립트는 소스를 실행전 평가를 먼저 진행한다.

이처럼 변수선언문이 코드의 선두로 끌어올려진것 처럼 동작하는 자바스크립트 특징을 호이스팅이라고 한다.

## 4.5. 값의 할당

값의 할당은 런타임 시점에 실행된다.

```ts
console.log(score);

score = 80;
var score;

console.log(score);
```

는 호이스팅이 먼저 일어나므로 실제로

```ts
var score;
console.log(score);

score = 80;

console.log(score);
```

와 같다.

## 4.6. 값의 재할당

재할당은 이미 값이 할당되어 있는 변수에 다시 새로운 값을 할당하는것을 말한다.

만약 값을 변경 할 수 없다면 변수가 아니라 상수라고 한다.

값을 재할당 하는것은 새로운 메모리에 다시 사용한다.

> **const 키워드**
>
> ES6에서 추가된 `const` 키워드를 사용해 선언한 변수는 재할당이 금지된다. 따라서 상수를 표현할 수 있다.
> 하지만 `const`는 반드시 상수만을 위해 사용하지 않는다.

> **가비지 콜렉터**
>
> 가비지 콜렉터는 주기적으로 어플리케이션이 할당한 메모리 공간을 주기적으로 검사하여 사용하지 않는 메모리를 해제 한다.
> 자바스크립트는 가비지 콜렉터를 내장한 매니지드 언어로 메모리 누수를 자동으로 관리한다.

> **언매니지드 언어와 매니지드언어**
>
> 메모리 관리방식에 따라 언매니지드, 매니지드 언어로 분류할 수 있습니다.
> C언어 같은 매니지드 언어는 사용자가 매모리할당과 해제를 주도 할 수 있으나 치명적 오류를 생산 할 수 있습니다.
> 자바스크립트 같은 언매니지드 언어는 사용자가 메모리를 관리할 권한은 없지만 메모리에 대한 오류가 발생할 확률이 적습니다. 하지만 성능면에서 손실은 감수해야하는 부분입니다.

## 4.7. 식별자와 네이밍 규칙

- 식별자는 특수문자를 제외한 문자, 숫자, 언더스코어, 달러기호를 사용할 수 있다.
- 단, 식별자는 숫자로 시작할 수 없다.
- 예약어는 식별자로 사용할 수 없다.
- ES5부터 유니코드 문자사용이 가능하다

> [자바스크립트 예약어(MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Lexical_grammar#reserved_words)

- 대소문자를 구분한다.
- 변수 이름은 목적을 쉽게 이해할 수 있도록 명확히 표현한다.
- 네이밍 컨벤션

  - 자바스크립트에서는 일반적으로 변수명은 카멜케이스 클레스나 생성자 함수 이름에는 파스칼케이스를 사용한다.

  - 카멜케이스

  ```ts
  const firstName;
  ```

  - 스네이크케이스

  ```ts
  const first_name;
  ```

  - 파스칼케이스

  ```ts
  const FirstName;
  ```

  - 헝가리언 케이스

  ```ts
  const strFirstName;
  ```

  - 케밥 케이스(자바스크립트 변수명으로는 사용불가능)

  ```ts
  <div className="table-td" />
  ```

## Question

> 마우스 오버를 하면 제가 생각한 이상적인 답변이 나옵니다?

- ![호이스팅에 대해 설명해주세요](https:// "자바스크립트 엔진은 코드를 실행하기 전 평가를 먼저하는데 이 때 코드의 변수 선언을 먼저 진행합니다. 이것을 호이스팅이라고 합니다. let과 const에서는 발생하지 않는것 처럼 보이는데 그 이유는 let과 const는 일시적 사각지대에 들어가기 때문입니다. v8엔진의 코드에서 var는 AllocateTo를 사용해 바로 메모리에 공간을 할당하고 undefined로 초기화 하지만 let과 const는 set_initializer_position 메소드를 통해 해당 코드의 위치를 의미하는 position값만 정해주기 때문입니다. 초기화가 되지 않기 때문에 일시적 사각지대라는 상태에 놓이게 됩니다.") ([이에 대한 좋은글](https://careerly.co.kr/comments/68614)+[정리된 글](https://ingg.dev/hoisting/))

- ![가비지콜렉터는 어떻게 동작하나요?](https:// "자바스크립트 객체는 참조카운터가 존재하고 참조 카운터가 0이된 객체들을 더이상 필요없는 객체라고 여기고 이것을 가비지라고 부릅니다. 가비지 컬렉터는 이런 가비지를 수집합니다. 라고 알고 있지만 최신 브라우저는 더이상 이 방식을 사용하지 않습니다. 최신브라우저는 Mark and sweep을 사용합니다. 이 알고리즘은 roots라는 객체 집합을 가지고 있고 가비지 콜렉터는 roots로 부터 도달할 수 있는 객체를 찾고 도달할 수 없는 모든 객체를 수집합니다.") ([MDN글](https://developer.mozilla.org/ko/docs/Web/JavaScript/Memory_management#%EA%B0%80%EB%B9%84%EC%A7%80_%EC%BD%9C%EB%A0%89%EC%85%98) + [정리된 글](https://ko.javascript.info/garbage-collection))
  - 꼬리 질문: WeekMaps와 WeekSets
